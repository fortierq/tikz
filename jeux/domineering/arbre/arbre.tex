\documentclass[convert={outfile=\jobname.png}]{standalone}
\usepackage{base}
\usepackage{draw}
\usepackage{code}

\begin{document}

\newcommand{\plat}[4]{
    \foreach \x in {0, ..., #3}{
            \draw (\x + #1, 0 + #2) -- (\x + #1, #2 + #4);
        }
    \foreach \y in {0, ..., #4}{
            \draw (#1, #2 + \y) -- (#1 + #3, #2 + \y);
        }
}
\newcommand{\domh}[4]{
    \draw[rounded corners, thick, fill = blue!40] (#1 + #3 + .1, #2 + #4 + .1) rectangle (#1 + #3 + 2-.1, #2 + #4 + 1-.1);
}

\newcommand{\domv}[4]{
    \draw[rounded corners, thick, fill = red!40] (#1 + #3 +.1, #2 + #4 +.1) rectangle (#1 + #3 + 1-.1, #2 + #4 + 2-.1);
}

\newcommand{\plato}[2]{
    \foreach \x in {0, ..., 3}{
            \draw (\x + #1, #2) -- (\x + #1, #2 + 2);}
    \foreach \y in {0, ..., 2}{
            \draw (#1, #2 + \y) -- (#1 + 3, #2 + \y);}
    \draw (#1 + 3, #2) rectangle (#1 + 4, #2 + 1);
}

\begin{tikzpicture}
    \plat{0}{0}{4}{4}
    \plat{5}{0}{4}{4}
    \plat{10}{0}{4}{4}
    \plat{15}{0}{4}{4}
    \plat{20}{0}{4}{4}
    \plat{25}{0}{4}{4}
    \plat{30}{0}{4}{4}
    \plat{35}{0}{4}{4}
    \plat{40}{0}{4}{4}
    \plat{45}{0}{4}{4}
    
    \plat{10}{10}{4}{4}
    \plat{30}{10}{4}{4}
    \plat{42.5}{10}{4}{4}
    
    \plat{22.5}{20}{4}{4}
    
    \foreach \xs/\ys/\xd/\yd in {22.5/20/12/14, 25.5/20/32/14, 26.5/20/44.5/14, 10/10/2/4, 11/10/7/4, 12/10/12/4, 13/10/17/4, 14/10/22/4, 30/10/27/4, 32/10/32/4, 34/10/37/4, 43.5/10/42/4, 45.5/10/47/4}
    \draw[arc] (\xs, \ys) -- (\xd, \yd);
    
    \foreach \x in {0, ..., 9}{
    \domv{\x * 5}{0}{1}{2}
    \domh{\x * 5}{0}{0}{1}
    \domh{\x * 5}{0}{2}{2}
    }
    
    \foreach \x/\y in {10/10, 30/10, 42.5/10, 22.5/20}{
    \domv{\x}{\y}{1}{2}
    \domh{\x}{\y}{0}{1}
    \domh{\x}{\y}{2}{2}
    }
    
    \domv{10}{10}{0}{2}
    \domv{30}{10}{3}{0}
    \domv{42.5}{10}{2}{0}
    
    \foreach \x in {0, ..., 4} {\domv{\x*5}{0}{0}{2}}
    \foreach \x in {5, 6, 7} {\domv{\x*5}{0}{3}{0}}
    \foreach \x in {8, 9} {\domv{\x*5}{0}{2}{0}}
    
    \domh{0}{0}{2}{3}
    \domh{5}{0}{2}{1}
    \domh{10}{0}{2}{0}
    \domh{15}{0}{0}{0}
    \domh{20}{0}{1}{0}
    
    \domh{25}{0}{2}{3}
    \domh{30}{0}{0}{0}
    \domh{35}{0}{1}{0}
    
    \domh{40}{0}{2}{3}
    \domh{45}{0}{0}{0}
    
    
    % \node[draw] at (-2, 2) {Max};
    % \node[draw] at (-2, 12) {Min};
    % \node[draw] at (-2, 23) {Max};
    
    % \foreach \x/\y/\s in {2/-1/-2, 7/-1/-\infty, 12/-1/-\infty, 17/-1/-1, 22/-1/-1, 27/-1/0, 32/-1/1, 37/-1/0, 42/-1/1, 47/-1/1, 15/12/-\infty, 35/12/0, 47.5/12/1, 27.5/22/1 }
    % \draw (\x, \y) node {$\s$};
\end{tikzpicture}

\end{document}
